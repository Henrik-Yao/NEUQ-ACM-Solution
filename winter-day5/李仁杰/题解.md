# 题解



## 7-1

```c++
#include <iostream>
#include <cmath>
using namespace std;

int n, q;
long long a[1000010];

void change(int i, int v) {
    while (i <= n) {
        a[i] += v;
        int k = i & (-i);
        i += k;
    }
}

long long sum(int i) {
    long long sum = 0;
    while (i > 0) {
        sum += a[i];
        int k = i & (-i);
        i -= k;
    }
    return sum;
}

int main() {
    cin >> n >> q;
    for (int i = 1; i <= n; i++) {
        int v;
        cin >> v;
        change(i, v);
    }
    for (int i = 0; i < q; i++) {
        int op, x, y;
        cin >> op >> x >> y;
        if (op == 1) change(x, y);
        else cout << sum(y) - sum(x - 1) << endl;
    }
}
```

利用树形数组解决区间问题



## 7-2

```c+
#include <iostream>
#include <vector>
#include <string>
using namespace std;

vector<char> chain; // 字符串链表，用数组模拟
bool isInsert = false;  // 是否是插入状态
int index = 0;

void moveToHome() {
    index = 0;
}

void moveToEnd() {
    index = chain.size();
}

void moveLeft() {
    if (index - 1 >= 0) {
        index--;
    }
}

void moveRight() {
    if (index + 1 <= chain.size()) {
        index++;
    }
}

void changeInsertstate() {
    isInsert = !isInsert;
}

void backspace() {
    if (chain.size() > 0) {
        chain.erase(chain.begin() + index - 1);
        index--;
    }
}

void input(char ch) {
    if (index == chain.size() - 1) {
        chain.push_back(ch);
    }
    else if (isInsert) {
        chain[index] = ch;
    }
    else {
        chain.insert(chain.begin() + index, ch);
    }
    index++;
}

string toString() {
    string res;
    for (const char& ch : chain)  res.push_back(ch);
    return res;
}

void op(const char& ch) {
    if (ch == '[') {
        moveToHome();
    }
    else if (ch == ']') {
        moveToEnd();
    }
    else if (ch == '{') {
        moveLeft();
    }
    else if (ch == '}') {
        moveRight();
    }
    else if (ch == '-') {
        changeInsertstate();
    }
    else if (ch == '=') {
        backspace();
    }
    else {
        input(ch);
    }
}

int main() {
    string line;    
    getline(cin, line);
    for (const char& ch : line) op(ch);
    cout << toString() << endl;
    return 0;
}
```



## 7- 3

```c++
#include <iostream>
using namespace std;

int main()
{
    int N, M, K, n, i = 1, t; 
    cin >> N >> M >> K;
    int* x = new int[N] {};
    if (N == 1) cout << "1 ";
    else
    {
        for (n = 0; n < N; n++)
        {
            if (n % 2 == 0)
            {
                t = 0;
                while (t < M - 1)
                {
                    i--;
                    if (i < 0)i = N - 1;
                    if (x[i] == 0)t++;
                }
                x[i] = 1;
                if (i == 0) cout << N << ' ';
                else cout << i << ' ';
            }
            if (n % 2 == 1)
            {
                t = 0;
                while (t < K - 1)
                {
                    i++;
                    if (i > N - 1)i = 0;
                    if (x[i] == 0)t++;
                }
                x[i] = 1;
                if (i == 0) cout << N << ' ';
                else cout << i << ' ';
            }
        }
    }
}
```



## 7-4

```c++
#include <iostream>
#include <set>
using namespace std;

int main() {
    int num;
    multiset<int> s;
    while (cin >> num) s.insert(num);
    for (auto it = s.begin(); it != --s.end(); it++) cout << *it << "->";
    cout << *(--s.end()) << endl;
    int temp = -1;
    for (auto it = s.begin(); it != s.end();) {
        if (*it % 2 == 1) {
            if(temp != -1) cout << temp << "->";
            temp = *it;
            s.erase(it++);
        }
        else it++;
    }
    if (temp != -1) cout << temp;
    cout << endl;
    for (auto it = s.begin(); !s.empty() && it != --s.end(); it++) cout << *it << "->";
    if (!s.empty()) cout << *(--s.end());
    s.clear();
}
```

使用STL实现



## 7-5

```C++
#include <iostream>
using namespace std;

int main() {
	string str;
	while(cin >> str){
        int top = 0;
        int num = 0;
        int len = str.size();
        for (int i = 0; i < len; i++) {
            if (str[i] == '(') {
                top++;
            }
            else
            {
                if (top == 0) {
                    num++;
                }
                else {
                    top--;
                }
            }
        }
        if (top == 0 && num == 0) {
            cout << "Match\n";
        }
        else {
            cout << num + top << endl;
            for(int i = 0; i < num; i++)
                cout << '(';
            cout << str;
            for(int i = 0; i < top; i++)
                cout << ')';
            cout << endl;
        }
    }
}
```

栈



## 7 -6

```c++
#include <iostream>
using namespace std;

int main() {
	string str;
	while(cin >> str){
        int top = 0;
        int num = 0;
        int len = str.size();
        for (int i = 0; i < len; i++) {
            if (str[i] == '(') {
                top++;
            }
            else
            {
                if (top == 0) {
                    num++;
                }
                else {
                    top--;
                }
            }
        }
        if (top == 0 && num == 0) {
            cout << "Match\n";
        }
        else {
            cout << num + top << endl;
            for(int i = 0; i < num; i++)
                cout << '(';
            cout << str;
            for(int i = 0; i < top; i++)
                cout << ')';
            cout << endl;
        }
    }
}
```

哈希字符串



## 7- 7

```c++
#include <iostream>
#include <string>
#include <stack>
#include <queue>
using namespace std;

string s;
stack<char> q;
queue<char> st;

void trans(){
    st.push('t');
    st.push('s');
    st.push('a');
    st.push('e');
    st.push('d');
    st.push('s');
    st.push('a');
    st.push('e');    
}

int main(){
    cin >> s;
    for(int i = 0; i < s.length(); i++){
        if(s[i] == 'B'){
            trans();
        }
        else if(s[i] == '('){
            char sita = s[++i];
            q.push(sita);
            while(s[++i] != ')'){
                q.push(s[i]);
                q.push(sita);
            }
            while(!q.empty()){
                st.push(q.top());
                q.pop();
            }
        }
    }
    while(!st.empty()){
        cout << st.front();
        st.pop();
    }
}
```

栈+队列



## 7-8

```c++
#include <iostream>
#include <cmath>
using namespace std;

typedef struct {
	char* base;
	char* top;
}Sqstack;

int main() {
	int flag = 1;
	string s;
	cin >> s;
	char* c = new char[s.length()];
	Sqstack stack;
	stack.base = c;
	stack.top = c;
	for (int i = 0; i < s.length(); i++) {
		if (s[i] == '[' || s[i] == '{' || s[i] == '(') {
			*stack.top = s[i];
			stack.top++;
		}
		else if (s[i] == ']' || s[i] == '}' || s[i] == ')') {
			switch(*(--stack.top)) {
			case '[': if (s[i] != ']') flag = 0; break;
			case '{': if (s[i] != '}') flag = 0; break;
			case '(': if (s[i] != ')') flag = 0; break;
			}
		}
        else continue;
	}

	if (stack.top != stack.base) flag = 0;
	if (flag) cout << "yes";
	else cout << "no";
}
```

栈



## 7-9

```c++
#include <iostream>
#include <cmath>
using namespace std;

typedef struct {
	char* base;
	char* top;
}Sqstack;

int main() {
	int flag = 1;
	string s;
	cin >> s;
	char* c = new char[s.length()];
	Sqstack stack;
	stack.base = c;
	stack.top = c;
	for (int i = 0; i < s.length(); i++) {
		if (s[i] == '[' || s[i] == '{' || s[i] == '(') {
			*stack.top = s[i];
			stack.top++;
		}
		else if (s[i] == ']' || s[i] == '}' || s[i] == ')') {
			switch(*(--stack.top)) {
			case '[': if (s[i] != ']') flag = 0; break;
			case '{': if (s[i] != '}') flag = 0; break;
			case '(': if (s[i] != ')') flag = 0; break;
			}
		}
        else continue;
	}

	if (stack.top != stack.base) flag = 0;
	if (flag) cout << "yes";
	else cout << "no";
}
```

栈



## 7-10

```c++
#include <iostream>
#include <cmath>
using namespace std;

typedef struct {
	char* base;
	char* top;
}Sqstack;

int main() {
	int flag = 1;
	string s;
	cin >> s;
	char* c = new char[s.length()];
	Sqstack stack;
	stack.base = c;
	stack.top = c;
	for (int i = 0; i < s.length(); i++) {
		if (s[i] == '[' || s[i] == '{' || s[i] == '(') {
			*stack.top = s[i];
			stack.top++;
		}
		else if (s[i] == ']' || s[i] == '}' || s[i] == ')') {
			switch(*(--stack.top)) {
			case '[': if (s[i] != ']') flag = 0; break;
			case '{': if (s[i] != '}') flag = 0; break;
			case '(': if (s[i] != ')') flag = 0; break;
			}
		}
        else continue;
	}

	if (stack.top != stack.base) flag = 0;
	if (flag) cout << "yes";
	else cout << "no";
}
```

栈